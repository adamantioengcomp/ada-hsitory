angular.module("history",[]).value("history",[]).value("status",{current:-1,goingBack:!1,goingForward:!1}).factory("History",["history","$location","status",function(r,n,t){return{backTo:function(n,i){t.goingBack=!0;for(var e in r)if(r[e]==n){t.current=e;var o=n;r=r.slice(0,Number(e)+1);break}if(o)for(e in i){var c=o.indexOf("?"+e+"=");if(0>c&&(c=o.indexOf("&"+e+"=")),c>-1){var a=o.substr(c+1);a.indexOf("&")>0&&(a=a.substr(0,a.indexOf("&"))),o=o.replace(a,e+"="+i[e])}else o+=o.indexOf("?")>-1?"&":"?",o+=e+"="+i[e]}window.location="#"+o},back:function(n){t.goingBack=!0,t.current>0?t.current--:t.current=0;var e=r.length>0?r[t.current]:"/";for(i in n){var o=e.indexOf("?"+i+"=");if(0>o&&(o=e.indexOf("&"+i+"=")),o>-1){var c=e.substr(o+1);c.indexOf("&")>0&&(c=c.substr(0,c.indexOf("&"))),e=e.replace(c,i+"="+n[i])}else e+=e.indexOf("?")>-1?"&":"?",e+=i+"="+n[i]}window.location="#"+e},forward:function(){t.goingForward=!0,t.current>0&&t.current<r.length-1?t.current++:t.current=0;var i=r.length>0?r[t.current]:"/";n.path(i)},clear:function(){t.current=0,r.splice(0,r.length)}}}]).run(["$rootScope","history","$location","status",function(r,n,i,t){var e=function(){t.goingBack||t.goingForward?(t.goingBack=!1,t.goingForward=!1):(t.current++,n[t.current]=i.$$url)};r.$on("$routeChangeSuccess",function(){e()}),r.$on("$stateChangeSuccess",function(){e()})}]);